# III. Related Work

## F. Research Gap and Positioning

本章回顧了區塊鏈聯邦學習中多聚合器驗證機制的現有研究，涵蓋PBFT方法（§B）、樂觀驗證機制（§C）、零知識證明方法（§D）與混合共識機制（§E）。儘管這些方案在各自的設計目標下取得了一定成果，但綜合分析顯示，現有技術路線仍面臨三大核心缺口（§F.1）。本節總結這些未解決問題，並明確本研究的定位與貢獻（§F.2）。

---

### F.1 三大未解決問題

透過前述章節的批判性分析，可歸納出現有多聚合器驗證方案的三大核心缺口：

**缺口1 - 委員會方法的長期安全脆弱性**

以FLCoin、VFChain、MCFLM-CB為代表的委員會驗證方法（§B.1），通過限制驗證者數量提升效率，並結合聲譽機制和滑動窗口篩選可信節點。這些方法在短期內能有效降低通訊複雜度（從O(n²)降至O(c²)，其中c為委員會規模）。然而，在長期運行的生產環境FL系統中（如醫療診斷模型訓練可能持續數月甚至數年），這類方案面臨**潛伏攻擊(Sleeper Attack)**的根本性威脅：

- **信任積累悖論**：攻擊者可在長期保持誠實行為以建立高聲譽，進入委員會後在關鍵時刻發動攻擊。聲譽系統反而成為攻擊者的「保護傘」。
- **有限記憶窗口**：滑動窗口的有限大小（通常100-200輪）無法檢測超長潛伏期的異常行為，攻擊者只需在窗口內保持誠實即可逃避偵測。
- **局部驗證盲區**：只有委員會成員參與驗證，若攻擊者控制委員會多數（>c/3），可通過內部共謀達成惡意共識，外部節點無法察覺。

這些問題的根源在於委員會方法將**信任機制作為唯一的安全保障**，缺乏密碼學共識的後備機制。當信任機制被攻破時，系統無法退回至強安全模式，導致長期運行的醫療、金融等關鍵FL應用的安全性堪憂。

**缺口2 - 純PBFT的雙重效率瓶頸**

以BlockDFL、IEEE 9223754為代表的純PBFT驗證方法（§B.2），通過每輪訓練都執行完整的拜占庭容錯共識，提供了強安全保證（f<n/3）。然而，這類「每輪都驗證」的策略造成嚴重的**計算冗餘問題**：

- **威脅無關的固定開銷**：即使當前輪次完全無威脅，仍需全體驗證者參與PBFT共識，每個驗證者都重複執行相同的聚合計算。
- **規模擴展性差**：隨驗證者數量V增長，每輪通訊複雜度為O(V²)。100個驗證者需約10,000次消息交換，1000個驗證者則需1,000,000次，規模擴展幾乎不可行。
- **無效率優化路徑**：缺乏樂觀執行模式，無法利用「大多數情況聚合器誠實」這一實際特性，資源浪費在過度驗證上。

這些問題的根源在於純PBFT方法**缺乏威脅感知機制**，無法區分正常輪次與異常輪次，也無法根據實時威脅動態調整驗證強度。在長期訓練場景中（訓練100-1000輪），累積的驗證開銷可能超過實際訓練計算本身。

**缺口3 - 樂觀/零知識方法的運算限制**

以opML（§C.1）和zkML（§D.1）為代表的樂觀驗證與零知識證明方法，在效率或安全性上具有獨特優勢。opML通過樂觀假設實現O(1)通訊複雜度，zkML提供數學級完整性保證。然而，這些方案為了實現特定的驗證機制，**犧牲了計算通用性**：

- **opML的FPVM限制**：
  - 記憶體上限4GB，無法處理大型模型（LLaMA-7B需14GB，超出3.5倍）
  - 複雜算法分解困難（FedProx、Krum等算法需實現優化器狀態、排序邏輯等）
  - 無GPU加速，驗證時間比原生計算慢30倍以上

- **zkML的算術化限制**：
  - 模型規模瓶頸（實際可行上限約18M參數，主流模型如BERT-large 340M已超出）
  - 算法通用性受限（只能高效處理簡單算術運算，複雜邏輯導致電路深度爆炸）
  - 證明生成開銷（ResNet50推理需55分鐘證明，相較原生計算慢1650倍）

這些限制的根源在於，FPVM虛擬機和零知識證明的算術化都需要將計算轉換為特定形式（虛擬機指令或算術電路），這個轉換過程本質上限制了**可驗證計算的表達能力**。在實際FL場景中，生產環境常涉及大型模型（7B+參數）和複雜聚合算法（拜占庭魯棒聚合、自適應優化等），這使得opML和zkML**無法支援真實世界的FL需求**。

### F.1.5 本研究的雙重效率優化框架

為解決上述三大缺口，本研究提出 **Optimistic-PBFT 混合機制**，在兩個獨立維度實現效率提升：

**優化維度1：計算負擔分散**（Architectural Design）
- **機制**：多聚合器輪替（Round-Robin）
- **效果**：每個聚合器 R/N 次，相對傳統 PBFT 降低 N 倍
- **來源**：架構設計，與共識機制無關

**優化維度2：通訊開銷降低**（Consensus Design）
- **機制**：樂觀通過（挑戰期 + 按需 PBFT）
- **效果**：正常情況 O(1)，相對傳統 PBFT 降低 V² 倍
- **來源**：共識設計，與多聚合器架構獨立

**雙重優化的關鍵洞察**：
1. **獨立性**：兩個優化來自不同層面（架構 vs 共識），互不依賴
2. **互補性**：共同作用產生乘法效應（計算×通訊）
3. **計算通用性**：相對於 opML/zkML，仲裁機制（PBFT）無計算限制

**效率提升總結**（R=100, N=10, V=21, p=0.05）：

| 維度 | 傳統 PBFT | 本研究 | 提升倍數 |
|------|-----------|--------|----------|
| 計算負擔（單節點） | R 次 | R/N 次 | N 倍 |
| 系統總計算量 | R×V | R×(1+p×V) | V/(1+p×V) ≈ 10倍 |
| 通訊開銷（每輪） | O(V²) | O(1) | V² 倍 |
| 總消息數 | R×3V² | R×(1+p×3V²) | 約 20倍 |

這種雙重優化使本研究在保持 Byzantine 容錯的同時，實現接近 opML 的效率，且無 FPVM/算術化的計算限制。具體設計與實現將在第IV章詳述。

---

### F.2 研究缺口總結與本研究定位

綜上所述，現有多聚合器驗證方案面臨**效率、安全性與計算通用性**的三難困境：

| 技術路線 | 效率 | 安全性 | 計算通用性 | 核心缺口 |
|---------|------|--------|-----------|---------|
| **委員會方法** (§B.1) | ✅ 高 (O(c²)) | ⚠️ 信任依賴 | ✅ 通用 | 長期安全脆弱性 |
| **純PBFT** (§B.2) | ❌ 低 (O(V²)) | ✅ 強 (f<n/3) | ✅ 通用 | 計算冗餘性 |
| **樂觀機制** (§C) | ✅ 高 (O(1)) | ✅ 中 (1-of-N) | ❌ FPVM限制 | 運算限制 |
| **零知識證明** (§D) | ❌ 低 (證明慢) | ✅ 強 (數學級) | ❌ 算術化限制 | 運算限制 |
| **混合方案** (§E) | ⚠️ 中 | ⚠️ 中 | ✅ 通用 | 靜態策略、缺乏動態感知 |

現有混合方案（如EPP-BCFL的PoS+BFT兩階段）嘗試平衡效率與安全，但仍採用**固定的驗證策略**，無論當前威脅等級如何都執行相同流程，無法根據實時安全狀況動態調整。這凸顯了一個核心研究問題：

> **能否設計一種動態威脅感知的驗證機制，在正常情況保持高效率，異常情況自動切換至強安全模式，同時支援任意模型規模和聚合算法？**

**本研究的定位與貢獻**

本研究通過**Optimistic-PBFT動態切換機制**回應上述研究問題，填補現有技術的缺口：

**(1) 動態威脅感知的雙模式運行**
- 結合樂觀執行與 PBFT 共識，根據實時威脅動態切換驗證強度
- 相較於委員會方法的「純信任」和純PBFT的「永遠驗證」，本研究實現「信任但驗證(Trust but Verify)」
- 雙重效率優化（計算分散 + 通訊降低）詳見§F.1.5，保持 f<n/3 的 Byzantine 容錯保證

**(2) 計算通用性的保障**
- 在**原生環境**執行驗證，無FPVM記憶體限制或算術化約束
- 支援任意模型規模（7B-175B+參數）和任意聚合算法（FedProx、Krum等）
- 可利用GPU/TPU硬體加速，驗證時間與原生計算相當
- 相較於opML和zkML的計算限制，本研究滿足生產環境FL的實際需求

**(3) 自適應安全參數調整**
- 根據挑戰率歷史動態調整安全參數（挑戰期長度、PBFT參與閾值等）
- 威脅等級感知：訓練初期低警戒、後期高警戒
- 相較於EPP-BCFL等靜態混合方案，本研究實現真正的自適應安全

下表總結本研究與現有方案的差異：

| 維度 | 現有方案 | 本研究 |
|------|---------|--------|
| 驗證觸發 | 每輪固定執行 (BlockDFL) <br> 或僅委員會驗證 (FLCoin) | 基於挑戰動態觸發PBFT |
| 威脅感知 | ❌ 靜態策略 | ✅ 挑戰率感知、自適應調整 |
| 正常情況效率 | O(c²) (委員會) <br> O(V²) (純PBFT) | O(R/N) (輪值聚合) |
| 異常情況安全 | 信任機制 (委員會) <br> 每輪PBFT (純PBFT) | 挑戰觸發PBFT (f<n/3) |
| 計算環境 | FPVM限制 (opML) <br> 算術化限制 (zkML) | 原生環境，無限制 |
| 模型規模 | ≤2B (opML) <br> ≤18M (zkML) | 任意規模 (7B-175B+) |
| 安全哲學 | 單一機制 | 雙層安全：樂觀+PBFT後備 |

**理論定位**

本研究的核心哲學是**「樂觀假設、密碼學保障」**：在許可鏈/聯盟鏈場景下（參與者身份已知、基礎信任度較高），系統樂觀假設聚合器誠實以實現高效率，但保留任意驗證者發起挑戰的能力，確保一旦發現異常立即切換至PBFT密碼學共識。這種設計避免了委員會方法對信任機制的過度依賴，也避免了純PBFT的計算冗餘，同時通過原生環境執行保障了計算通用性。

**過渡至第IV章**：本章分析凸顯了動態威脅感知機制的必要性與現有技術的缺口。下一章（第IV章 Methodology）將詳細描述本研究提出的Optimistic-PBFT動態切換機制的具體設計，包括系統架構（§IV.A）、輪值聚合器的輪換機制（§IV.B）、樂觀執行與挑戰觸發流程（§IV.C）、PBFT共識驗證的實現細節（§IV.D）以及經濟激勵與懲罰機制（§IV.E）。
