# 2.2 區塊鏈聯邦式學習 (Blockchain-based Federated Learning, BCFL)

區塊鏈聯邦式學習透過結合分散式帳本技術與聯邦學習架構,從根本上解決了傳統聯邦學習的**信任集中化困境**。本節將系統性地闡述 BCFL 的技術動機、架構演進脈絡、委員會共識機制設計,以及現有方案在委員會安全性上的不足——這些不足正是本研究欲填補的關鍵缺口。

## 2.2.1 BCFL 的動機:解決信任問題

### 中央化架構的脆弱性

傳統聯邦學習雖聲稱「資料不出本地」,但其架構核心仍仰賴單一中央聚合器,這導致三類根本性的信任風險。**第一,聚合器惡意行為風險**:中央伺服器可執行選擇性聚合(僅納入特定客戶端更新)、結果篡改(植入後門或偏差模型),甚至透過梯度推論攻擊重建原始訓練資料——NeurIPS 2020 研究顯示,即便是 ImageNet 等級的 ResNet 模型,攻擊者仍可從梯度中重建訓練影像 [1]。**第二,單點故障 (SPOF)**:當中央伺服器因攻擊、故障或網路問題而離線,整體訓練流程即刻癱瘓,且缺乏有效的復原機制。**第三,拜占庭將軍問題**:惡意客戶端可注入中毒模型更新,而中央聚合器本身亦可能與攻擊者共謀;USENIX Security 2020 研究指出,針對性的模型中毒攻擊可使全域模型錯誤率提升達 **90%** [2]。

| 風險類型 | 描述 | 影響 | 傳統方案局限 |
|---------|------|------|-------------|
| 選擇性聚合 | 伺服器選擇性納入/排除客戶端更新 | 模型偏差、貢獻浪費 | 無法驗證伺服器決策 |
| 結果篡改 | 聚合器修改全域模型 | 後門植入、效能劣化 | 客戶端無法驗證聚合正確性 |
| 梯度推論攻擊 | 從梯度推斷私有資料 | 成員推論、資料重建 | 差分隱私降低準確度 |
| 單點故障 | 中央伺服器不可用 | 訓練中斷、進度遺失 | 冗餘伺服器引入新信任問題 |
| 拜占庭攻擊 | 惡意節點發送中毒更新 | 模型準確度下降達 90% | 穩健聚合於惡意比例 >50% 時失效 |

### 區塊鏈特性與信任問題的對應

區塊鏈的三大核心特性恰好對應中央化聯邦學習的信任困境:**不可篡改性**確保一旦聚合結果上鏈即無法竄改,任何篡改企圖將導致雜湊不符;**透明性**使所有提交的更新與聚合邏輯對全體參與者可見,選擇標準編碼於智能合約中;**去中心化**則消除對單一實體的信任依賴,透過共識機制確保系統持續運作。

| FL 信任問題 | 對應區塊鏈特性 | 解決機制 |
|------------|---------------|---------|
| 結果篡改 | 不可篡改性 | 聚合模型雜湊上鏈,客戶端使用前驗證 |
| 選擇性聚合 | 透明性 | 智能合約定義可驗證的選擇規則 |
| 單點故障 | 去中心化 | 多節點維護系統狀態,P2P 模型聚合 |
| 缺乏可審計性 | 不可篡改性 + 透明性 | 完整訓練歷程記錄於鏈上 |

BCFL 的三項核心優勢因而顯現:**消除單點故障**——區塊鏈以分散式網路取代中央聚合器,任一節點失效時其他節點可無縫接續,研究顯示 BCFL 在節點故障情況下仍可維持 90% 以上準確度;**防篡改的可審計性**——不可變帳本建立永久可驗證的操作紀錄,智能合約強制執行確定性聚合規則;**拜占庭容錯的激勵對齊**——結合 BFT 共識協議與加密貨幣獎勵機制,可容忍最多 $f < n/3$ 的惡意節點,同時透過押金機制懲罰惡意行為。

## 2.2.2 BCFL 架構演進

### 演進時間線

BCFL 架構經歷了從「全節點共識」到「委員會共識」的關鍵演進。**2018-2020 年的基礎期**以 BlockFL [3] 為代表,採用工作量證明 (PoW) 作為共識機制,礦工驗證本地模型更新後打包區塊,消除了對中央伺服器的依賴;然而 PoW 的高能耗與長共識延遲使其難以適用於資源受限的邊緣運算場景。**2020-2021 年的委員會共識興起期**以 BFLC [4] 為里程碑,引入委託式委員會共識,將共識運算從全網 $O(n^2)$ 降至委員會內 $O(C^2)$,並採用 K-fold 交叉驗證檢測惡意更新;Lu et al. [5] 更提出將 FL 訓練品質融入共識的「Proof of Training Quality」。**2023-2024 年的優化期**則以 FLCoin [6] 的滑動視窗委員會與 BlockDFL [7] 的雙層評分機制為代表,前者將通訊複雜度進一步降至線性 $O(s)$,後者則將拜占庭容忍度提升至 **40%**。

### 代表性系統比較表

| 系統 | 年份 | 共識機制 | 通訊複雜度 | 容錯能力 | 主要創新 | 主要局限 |
|-----|------|---------|-----------|---------|---------|---------|
| BlockFL [3] | 2020 | PoW | 依 PoW 難度 | 50% 算力 | 首個 BCFL 框架、延遲模型分析 | 高能耗、長共識延遲 |
| BFLC [4] | 2021 | 委員會共識 | $O(C^2)$ | 33% (3f+1) | 委員會共識、K-fold 驗證 | 委員會資源負擔重、易被惡意滲透 |
| Lu et al. [5] | 2020 | Proof of Training Quality | IIoT 優化 | 33% | 共識與訓練整合 | 需可信實體 |
| BlockDFL [7] | 2024 | PBFT 投票 | $O(\text{agg} \times \text{ver})$ | **40%** | 雙層評分、梯度壓縮 | 聚合器數量影響延遲 |
| FLCoin [6] | 2024 | 滑動視窗委員會 | $O(s)$ 線性 | <25% | 90% 通訊降低、35% 訓練加速 | 視窗大小需權衡 |

### 從全節點到委員會的演進動力

全節點共識的核心瓶頸在於**通訊複雜度與可擴展性的矛盾**:傳統 PBFT 需 $O(n^2)$ 訊息交換,當節點數達數百時,共識延遲將嚴重拖累 FL 訓練週期。委員會機制透過選取規模 $C \ll n$ 的代表節點執行共識,將複雜度降至 $O(C^2)$ 甚至 $O(C)$。FLCoin 實驗顯示,當 $n=500$ 時,採用 $s=100$ 的滑動視窗可將通訊負擔降低 **90%**,共識延遲維持在 **3 秒以內**,單輪迭代時間約 7 秒(對比 Biscotti 的 40 秒)。這種架構轉變的代價是引入了新的安全假設:委員會的安全性取決於其組成是否被惡意節點控制。

## 2.2.3 委員會機制的技術細節

### 委員會選擇機制比較

委員會選擇方法直接影響系統的安全性與公平性,現有方案可分為四類:

| 選擇方法 | 優點 | 缺點 | 代表系統 |
|---------|------|------|---------|
| **隨機選擇** | 不可預測、防止針對性攻擊 | 可能選到惡意或低品質節點 | BFLC, RapidChain |
| **權益導向** | Sybil 抵抗、經濟安全保障 | 中心化風險(富者愈富) | Ethereum 2.0, DPoS-based FL |
| **聲譽導向** | 獎勵可靠貢獻者、過濾惡意節點 | 聲譽壟斷、易被長期培養攻擊 | BESIFL, PoQ-based BCFL |
| **貢獻導向** | 與 FL 目標直接對齊 | 新加入者劣勢、指標可被博弈 | FLCoin |

### 委員會大小的安全性分析

委員會安全性依循**超幾何分佈**建模。當從 $n$ 個節點(含 $m$ 個惡意節點)中選取 $C$ 個組成委員會時,恰有 $k$ 個惡意節點被選中的機率為:

$$P(X = k) = \frac{\binom{m}{k} \binom{n-m}{C-k}}{\binom{n}{C}}$$

委員會被攻破的機率(惡意節點超過 BFT 閾值 $\beta = 1/3$)為:

$$P(\text{compromised}) = \sum_{k=\lceil \beta C \rceil}^{\min(m,C)} P(X=k)$$

**數值範例**:設 $n=100$、$m=30$(30% 惡意)、$C=10$,計算惡意節點過半($k \geq 6$)的機率:

$$P(X \geq 6) \approx 0.0315 + 0.00645 + 0.00082 + 0.00006 \approx \mathbf{3.88\%}$$

此風險對生產系統而言過高。FLCoin 實驗顯示,將委員會規模提升至 $C=50$ 可達 **91.3%** 安全機率,$C=100$ 則達 **98.4%**,但通訊負擔亦隨之增加——這正是委員會機制的核心權衡。

## 2.2.4 智能合約在 BCFL 中的角色

### 功能模組

BCFL 中的智能合約承擔四項核心功能:**註冊模組**管理客戶端登入,驗證資格、記錄錢包地址與訓練能力、收取押金,並維護經驗證的參與者清單;**聚合模組**協調模型更新的彙整,管理輪次同步、收集模型雜湊、執行聚合演算法(如 FedAvg),並儲存結果;**驗證模組**在聚合前驗證模型更新,評審者以測試資料集評估提交模型,計算貢獻分數並過濾惡意更新;**獎勵模組**依據貢獻分配激勵,透過 ERC-20 代幣自動轉帳,並對惡意行為執行押金沒收。

### 鏈上 vs 鏈下聚合比較

| 方式 | 優點 | 缺點 | 適用場景 |
|-----|------|------|---------|
| **鏈上聚合** | 完全透明、確定性執行、防篡改 | Gas 成本極高、擴展性受限 | 小型模型、高審計需求應用 |
| **鏈下聚合** | 低成本、支援大型模型、高效 | 需信任聚合器、透明度較低 | 大規模 FL、生產環境部署 |

研究顯示,百萬參數級模型的鏈上聚合 Gas 成本將達數百萬單位,遠超實用範圍。主流方案採用**混合架構**:鏈下執行聚合運算,僅將模型雜湊(約 32 bytes)上鏈存證,實際模型存於 IPFS。

### 獎勵機制設計

理論基礎最紮實的獎勵機制採用合作賽局論的 **Shapley 值**。節點 $i$ 的 Shapley 值定義為:

$$\phi_i = \sum_{S \subseteq N \setminus \{i\}} \frac{|S|!(|N|-|S|-1)!}{|N|!} [v(S \cup \{i\}) - v(S)]$$

其中 $v(S)$ 為聯盟 $S$ 的效用函數(通常為驗證集準確度)。FedCoin [8] 實作 Proof-of-Shapley 協議,依據各節點對模型改進的邊際貢獻分配獎勵:$\text{Reward}_i = (\phi_i / \sum_j \phi_j) \times \text{TotalBudget}$,確保公平性、預算平衡與零貢獻零報酬。

## 2.2.5 FedBlock 指出的委員會機制弱點 (Research Gap)

現有委員會共識機制存在若干尚未解決的關鍵弱點,構成本研究的重要切入點。FedBlock (Nguyen et al., 2024) [9] 在其未來展望章節明確指出:「目前版本中,智能合約以隨機方式選取客戶端作為驗證者,**但此選擇標準可能並非最佳**」;更進一步指出「驗證者本身亦可能是惡意的,結果可能在通訊中遺失,或參與驗證者不足,導致客戶端收到錯誤或缺失的驗證分數」,且「FedBlock 要在實務上可用,**需要一套激勵機制來鼓勵誠實驗證者的參與**」。

BFLC [4] 的委員會滲透弱點更為關鍵。2024 年 Taylor & Francis 的文獻回顧明確指出:「BFLC 採用委員會共識,**然而它容易被惡意節點混入委員會,從而導致系統偏差**」[10]。FLCoin 的分析亦顯示,即便採用 $s=50$ 的滑動視窗,仍有 **8.7%** 的機率選出不安全委員會。

綜合現有文獻,委員會機制的核心研究缺口包括:**缺乏針對委員會滲透的穩健防禦**——現有隨機或貢獻導向選擇易被博弈;**缺乏委員會操縱攻擊的形式化安全分析**;**缺乏考量歷史行為、模型品質與拜占庭抵抗能力的適應性選擇機制**;以及**缺乏可證明阻止惡意驗證者行為的激勵相容驗證機制**。這些缺口為本研究後續章節提出的方法論奠定了基礎。

---

## References

[1] J. Geiping et al., "Inverting Gradients - How easy is it to break privacy in federated learning?," in *Proc. NeurIPS*, 2020.

[2] M. Fang et al., "Local Model Poisoning Attacks to Byzantine-Robust Federated Learning," in *Proc. USENIX Security*, 2020.

[3] H. Kim, J. Park, M. Bennis, and S.-L. Kim, "Blockchained On-Device Federated Learning," *IEEE Commun. Lett.*, vol. 24, no. 6, pp. 1279-1283, Jun. 2020.

[4] Y. Li, C. Chen, N. Liu, H. Huang, Z. Zheng, and Q. Yan, "A Blockchain-Based Decentralized Federated Learning Framework with Committee Consensus," *IEEE Netw.*, vol. 35, no. 1, pp. 234-241, Jan. 2021.

[5] Y. Lu, X. Huang, Y. Dai, S. Maharjan, and Y. Zhang, "Blockchain and Federated Learning for Privacy-Preserved Data Sharing in Industrial IoT," *IEEE Trans. Ind. Informat.*, vol. 16, no. 6, pp. 4177-4186, Jun. 2020.

[6] S. Ren, E. Kim, and C. Lee, "A scalable blockchain-enabled federated learning architecture for edge computing," *PLOS ONE*, vol. 19, no. 8, e0308991, Aug. 2024.

[7] Z. Qin, X. Yan, M. Zhou, P. Zhao, and S. Deng, "BlockDFL: A Blockchain-based Fully Decentralized Peer-to-Peer Federated Learning Framework," in *Proc. ACM Web Conf.*, 2024.

[8] Y. Liu et al., "FedCoin: A Peer-to-Peer Payment for Federated Learning," arXiv:2002.11711, 2020.

[9] D. H. Nguyen, A. X. Hoang, D. V. Tran, H. Nguyen, and D. A. Tran, "FedBlock: A Blockchain Approach to Federated Learning against Backdoor Attacks," in *Proc. IEEE BigData*, 2024.

[10] Taylor & Francis, "A Blockchain-based Federated Learning Framework for Secure Aggregation and Fair Incentives," 2024.